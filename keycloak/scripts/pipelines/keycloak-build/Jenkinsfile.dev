#!groovy

node('build-slave') {

    currentBuild.result = "SUCCESS"

    try {

      stage('Build'){
          sh('cd sunbird-devops/ansible && ansible-playbook -i ../../ansible/inventories/dev  keycloak.yml --tags deploy --vault-password-file  /run/secrets/vault-pass ')
      }

      stage('Archive'){
          archiveArtifacts 'keycloak_build/login.tar.gz'
          archiveArtifacts 'keycloak_build.tar.gz'
      }
    }
    catch (err) {
        currentBuild.result = "FAILURE"
        throw err
    }
}
